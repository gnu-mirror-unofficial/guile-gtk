<html lang="en">
<head>
<title>Gtk Guile </title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="How to install and use the Guile interface to Gtk, version .">
<meta name="generator" content="makeinfo 4.5">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home">
<!--
This manual describes how to install and use the Guile interface to Gtk,
version .

   <p>Copyright 2003 Kevin Ryde.

   <p>Permission is granted to make and distribute verbatim copies of
this manual provided the copyright notice and this permission notice
are preserved on all copies.

   <p>Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the entire
resulting derived work is distributed under the terms of a permission
notice identical to this one.

   <p>Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions,
except that this permission notice may be stated in a translation approved
by Free Software Foundation.-->
</head>
<body>
<div class="node">
<p>
Node:<a name="Gdk%20Module">Gdk Module</a>,
Next:<a rel="next" accesskey="n" href="Gdk-Extras.html#Gdk%20Extras">Gdk Extras</a>,
Previous:<a rel="previous" accesskey="p" href="General-Conventions.html#General%20Conventions">General Conventions</a>,
Up:<a rel="up" accesskey="u" href="index.html#Top">Top</a>
<hr><br>
</div>

<h2 class="chapter">Gdk Module</h2>

<p>The Gdk interface module can be used with

<pre class="example">     (use-modules (gtk gdk))
     </pre>

   <p>A call to <code>gdk_init</code> is made automatically, an application doesn't need
to do that itself.  Standard Gdk command line options are taken from the
program command line (eg. <code>--display</code>), and removed from there, leaving
other options and the rest of the command line for the application. 
see <a href="../guile/Runtime-Environment.html#Runtime%20Environment">Runtime Environment</a>.

   <p>Currently, the <code>(gtk gdk)</code> module also initializes Gtk (<code>gtk_init</code>
etc, See <a href="Gtk-Module.html#Gtk%20Module">Gtk Module</a>.)  Perhaps this will change in the future.

   <p>The following rules apply to the various Gdk types.

     <dl>
<dt>Equality
     <dd>Currently Gdk objects (such as <code>GdkWindow</code>) are not uniquely represented
by a single Scheme level object, meaning they cannot be compared with
<code>eq?</code>, and unfortunately currently <code>equal?</code> cannot be used either. 
Standard Gdk functions like <code>gdk-font-equal</code> and <code>gdk-color-equal</code>
can be used in the usual way though.

     <br><dt><code>GdkAtom</code>
     <dd>Atoms are passed and returned as Guile symbols, for example <code>WM_NAME</code>.

     <br><dt><code>GdkColor</code>
     <dd>As a convenience, functions expecting a <code>GdkColor</code> object can be passed a
string, which will be parsed and allocated in the default colormap, using
<code>gdk-color-intern</code> (see <a href="Gdk-Extras.html#Gdk%20Extras">Gdk Extras</a>).

     <p>The following field accessors and setters are provided,

     <p>
<table width="100%">
<tr>
<td align="left"><b>gdk-color-red</b><i> color
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-color-blue</b><i> color
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-color-green</b><i> color
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-color-pixel</b><i> color
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-color-set-red</b><i> color red
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-color-set-blue</b><i> color blue
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-color-set-green</b><i> color green
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-color-set-pixel</b><i> color pixel
          </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
</td></tr>
</table>

     <br><dt><code>GdkDragContext</code>
     <dd>The following field accessors are provided,

     <p>
<table width="100%">
<tr>
<td align="left"><b>gdk-drag-context-action</b><i>
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-drag-context-actions</b><i>
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-drag-context-dest-window</b><i>
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-drag-context-is-source</b><i>
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-drag-context-source-window</b><i>
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-drag-context-start-time</b><i>
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-drag-context-suggested-action</b><i>
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-drag-context-targets</b><i>
          </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
</td></tr>
</table>

     <br><dt><code>GdkEvent</code>
     <dd>The following field accessors are provided.  Consult the Gdk documentation for
which fields are available in which event types.

     <p>
<table width="100%">
<tr>
<td align="left"><b>gdk-event-type</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-area</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-atom</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-button</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-count</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-crossing-mode</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-configure-x</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-configure-y</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-configure-width</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-configure-height</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-deviceid</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-drag-context</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-focus</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-in</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-is-hint</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-keyval</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-message</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-message-type</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-notify-detail</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-send-event</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-pressure</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-property</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-requestor</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-selection</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-source</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-state</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-string</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-subwindow</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-target</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-time</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-visibility-state</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-window</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-x</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-y</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-xtilt</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-ytilt</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-x-root</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gdk-event-y-root</b><i> e
          </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<code>gdk-event-x</code> and <code>gdk-event-y</code> returns pointer positions (floating
point), eg. for motion notify.  <code>gdk-event-configure-x</code> and
<code>gdk-event-configure-y</code> on the other hand return the window position
(integers) for a configure notify.

          <p><code>gdk-event-state</code> returns <code>GdkModifierType</code> flags, eg. for a key
press event.  <code>gdk-event-visibility-state</code> on the other hand returns a
<code>GdkVisibilityState</code> for a visibility notify event.

          <p><code>gdk-event-message</code> returns its data as a vector of 5, 10 or 20 integers,
according to the data format (32, 16, or 8 bits, respectively). 
</td></tr>
</table>

     <br><dt><code>GdkFont</code>
     <dd>As a convenience, functions expecting a <code>GdkFont</code> object can be passed a
string, which will be loaded as per <code>gdk-font-intern</code> (see <a href="Gdk-Extras.html#Gdk%20Extras">Gdk Extras</a>).

     <br><dt><code>GdkPoint</code>
     <dd>Points are represented as a pair <code>(x . y)</code>.  (see <a href="../guile/Pairs.html#Pairs">Pairs</a>)

     <br><dt><code>GdkRectangle</code>
     <dd>Rectangles are represented as a pair of pairs <code>((x . y) . (width
. height))</code>.  Notice that the <code>(x . y)</code> pair corresponds to the way a
<code>GdkPoint</code> is represented.

     <br><dt><code>GdkSegment</code>
     <dd>Segments are represented as a pair of pairs <code>((x1 . y1) . (x2 . y2))</code>. 
Notice each <code>(x . y)</code> corresponds to the way a <code>GdkPoint</code> is
represented.

     <br><dt><code>GdkWChar</code>
     <dd>Currently <code>GdkWChar</code> values are represented as integers, and
<code>GdkWChar</code> strings as vectors of integers.  So for instance
<code>gdk-wcstombs</code> expects such a vector.

     <p>This representation might change in the future if Guile gets its own notion of
characters bigger than 8 bits.

     <br><dt><code>GdkWindow</code>
     <dd>As per <code>gdk_window_unref</code>, windows are not destroyed automatically when
garbage collected, an application should call <code>gdk-window-destroy</code> to do
this.  Gtk prints a warning message if an undestroyed window's reference count
reaches zero.

     <p>Of course an application only needs to destroy windows it creates explicitly
(with <code>gdk-window-new</code>).  Widget windows are destroyed by the widget code
(when the widget is unrealized or destroyed).

     <br><dt>Pixels
     <dd>Pixels are represented as integers, in the usual Gdk fashion.  Guile Gtk makes
no attempt to track what pixels are allocated in what colormaps, any
management of that is left to applications. 
</dl>

<br><p>
<p>The following standard Gdk functions have particular notes for the Guile Gtk
interface.

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-color-black</b><i> colormap
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-color-white</b><i> colormap
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
The return value is a <code>GdkColor</code> object with red/green/blue fields set
and the pixel allocated in the given <var>colormap</var>, or <code>#f</code> if
allocation fails. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-color-hash</b><i> color
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Return a value hashed from the colour fields of a <code>GdkColor</code> object.

     <p>In Gtk 1.2, the C function <code>gdk_color_hash</code> actually takes two colour
objects, but only pays attention to the first.  Guile Gtk takes just one since
this is apparently the intention (and is what Gtk 2.0 does). 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-gc-get-values</b><i> gc
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<code>GdkGCValues</code> is not used, instead the return is a list,

     <pre class="example">          (foreground background font function fill
           tile stipple clip-mask subwindow-mode
           ts-x-origin ts-y-origin clip-x-origin clip-y-origin
           graphics-exposures line-width line-style cap-style join-style)
          </pre>
     </td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-mbstowc</b><i> str
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Convert a string of multi-byte characters to wide characters.  The return is a
vector of integers (per notes for <code>GdkWChar</code> above), or <code>#f</code> if
conversion failed. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-pixmap-create-from-xpm</b><i> window bitmaploc transpcolor filename
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-pixmap-colormap-create-from-xpm</b><i> window colormap bitmaploc transpcolor filename
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-pixmap-create-from-xpm-d</b><i> window bitmaploc transpcolor string
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-pixmap-colormap-create-from-xpm-d</b><i> window colormap bitmaploc transpcolor string
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Return a <code>GdkPixmap</code> created from an XPM file or string data.

     <p><var>bitmaploc</var> is a vector or list of length 1, into which the
<code>GdkBitmap</code> created for the transparency mask is stored.  If the bitmap
is not wanted, <var>bitmaploc</var> can be <code>#f</code>. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-rgb-init</b><i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
There's no need to call <code>gdk-rgb-init</code> before using the GdkRgb functions,
this is done automatically (as it is in Gdk 2.0).  <code>gdk-rgb-init</code> is
still available though, and can be used to force initialization earlier. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-set-locale</b><i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<code>gdk-set-locale</code> is called automatically when the <code>(gtk gdk)</code> module
is loaded, so applications don't need to do so explicitly. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-window-get-deskrelative-origin</b><i> window
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-window-get-origin</b><i> window
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-window-get-position</b><i> window
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-window-get-root-origin</b><i> window
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-window-get-size</b><i> window
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Unlike other multiple-return values functions, these return a pair <code>(x
. y)</code> or <code>(width . height)</code>, rather than a list. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-window-new</b><i> parent width height event-mask wclass wtype </i>[<i>#:colormap colormap</i>]<i> </i>[<i>#:cursor cursor</i>]<i> </i>[<i>#:title title</i>]<i> </i>[<i>#:visual visual</i>]<i> </i>[<i>#:wmclass name class</i>]<i> </i>[<i>#:x x</i>]<i> </i>[<i>#:y y</i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
The <code>GdkWindowAttr</code> structure is not used, instead <code>gdk-window-new</code>
takes arguments for the various attributes.  The first six are the mandatory
attributes, then keywords and values for the optional attributes.  For
example, for a top-level window,

     <pre class="example">          (gdk-window-new #f 200 100 '(exposure-mask) 'input-output 'toplevel
                          #:title "my window")
          </pre>
     </td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-pixmap-new</b><i> drawable width height </i>[<i>depth</i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<var>depth</var> defaults to -1, meaning copy from <var>drawable</var>. 
</td></tr>
</table>

<br><p>
<p>The following standard Gdk functions are not provided, for the reasons
outlined.

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-init</b><i>
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-init-check</b><i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
There are no separate init functions to call, all initializations are done
automatically when the <code>(gtk gdk)</code> module is loaded. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gdk-window-get-user-data</b><i> window
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gdk-window-set-user-data</b><i> window data
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Gtk sets the "user data" on a window to point to the associated widget, and
uses this for event dispatch.  And non-widget windows need <code>NULL</code> to
avoid another value being treated as a widget pointer.  On this basis the user
data generally cannot be used by applications.

     <p>Perhaps in the future <code>GdkWindow</code> objects will be uniquely represented,
allowing Guile object properties to do the sort of thing a user data pointer
might. 
</td></tr>
</table>

   </body></html>

