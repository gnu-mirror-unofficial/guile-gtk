<html lang="en">
<head>
<title>Gtk Guile </title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="How to install and use the Guile interface to Gtk, version .">
<meta name="generator" content="makeinfo 4.5">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home">
<!--
This manual describes how to install and use the Guile interface to Gtk,
version .

   <p>Copyright 2003 Kevin Ryde.

   <p>Permission is granted to make and distribute verbatim copies of
this manual provided the copyright notice and this permission notice
are preserved on all copies.

   <p>Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the entire
resulting derived work is distributed under the terms of a permission
notice identical to this one.

   <p>Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions,
except that this permission notice may be stated in a translation approved
by Free Software Foundation.-->
</head>
<body>
<div class="node">
<p>
Node:<a name="Gtk%20Extras">Gtk Extras</a>,
Next:<a rel="next" accesskey="n" href="GdkPixbuf-Module.html#GdkPixbuf%20Module">GdkPixbuf Module</a>,
Previous:<a rel="previous" accesskey="p" href="Gtk-Module.html#Gtk%20Module">Gtk Module</a>,
Up:<a rel="up" accesskey="u" href="index.html#Top">Top</a>
<hr><br>
</div>

<h2 class="chapter">Gtk Extras</h2>

<p>The following extra Gtk level functions are provided by Guile Gtk.

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-callback-trampoline</b><i> </i>[<i>tramp</i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Get or set the trampoline procedure for Gtk callbacks.  With no arguments, the
current trampoline is returned.  With an argument, the trampoline procedure is
set, and the old procedure returned.

     <p>When making a callback for signals etc, Guile Gtk goes through this
trampoline.  <var>tramp</var> is called as <code>(</code><var>tramp</var><code> proc args)</code>, where
<code>proc</code> is the application procedure to call, and <code>args</code> is a list of
arguments for it (possibly empty).  A minimal trampoline would be,

     <pre class="example">          (define (my-trampoline proc args)
            (apply proc args))
          </pre>

     <p>(which of course is just <code>apply</code> itself, no need for a new definition).

     <p>The default trampoline uses <code>catch</code> to trap errors from the callback, and
displays them in a window (see <a href="../guile/Catch.html#Catch">Catching Exceptions</a>).  The aim is to give the user some feedback in the
GUI about what has gone wrong, rather than suddenly terminating.  An
application can set a new trampoline to do this in its preferred way. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-class-new</b><i> type name
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Return a new <code>GtkType</code> with the given <var>name</var> (a string), created as a
sub-class of <var>type</var>.

     <p>Instances of the new type can be created with <code>gtk-widget-new</code> in the
usual way.  The new type has the same size as the given <var>type</var>, there's no
mechanism to add extra data fields.  Guile object properties can be used for
such things (see <a href="../guile/Object-Properties.html#Object%20Properties">Object Properties</a>)

     <p>The main advantage of a new class is that it can be type checked in a fashion
similar to other Gtk objects.  For instance,

     <pre class="example">          (define my-foo-button-type
            (gtk-class-new 'GtkButton "MyFooButton")))
          
          (define (my-foo-button-new)
            (gtk-widget-new my-foo-button-type #:label "something")))
          
          (define (my-foo-button? obj)
            (gtk-check-type obj my-foo-button-type))
          
          (define (my-foo-button-dosomething obj)
            (or (my-foo-button? obj)
                (error "Wrong object type: ~a" obj))
            ...)
          </pre>
     </td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-pixmap-new-from-file</b><i> filename parent
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Return a new <code>GtkPixmap</code> widget, containing an XPM image loaded from
<var>filename</var> as per <code>gdk-pixmap-colormap-create-from-xpm</code>. 
<var>parent</var> is an intended parent widget, used to get the colormap for the
image. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-signal-new-generic</b><i> name flags objtype rettype paramtypes
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Create a new signal <var>name</var> for use by <var>objtype</var> and return the signal
ID (an integer).  <var>flags</var> is <code>GtkSignalRunType</code> flags, <var>rettype</var>
is the return type for the handler, and <var>paramtypes</var> is a list of
parameter types for it.

     <p>This function is like the C function <code>gtk_signal_newv</code>, but doesn't setup
any particular marshaller, rather it's for use with Scheme level handlers
which are invoked "generically" based on the type information provided.

     <p>For instance to add a new signal to <code>GtkAdjustment</code>, taking a string and
a boolean as parameters.  Clearly Gtk itself won't use or emit something like
this, it'd just be for an application.

     <pre class="example">          (gtk-signal-new-generic "big_change_soon" '(no-recurse)
                                  'GtkAdjustment
                                  'void '(GtkString gboolean))
          </pre>
     </td></tr>
</table>

<br><p>
<p>The following functions are provided by

<pre class="example">     (use-modules (gtk threads))
     </pre>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-threads-ensure-handler</b><i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Start a Gtk main loop in a new Guile thread, if this function has not
previously done that.  This is a convenient way for an application to ensure a
main loop exists, but continue with other things.

     <p>The main loop is started within a <code>gdk-threads-enter</code> /
<code>gdk-threads-leave</code> pair in the standard way for a threaded program, as
per the following.

     <pre class="example">          (gdk-threads-enter)
          (gtk-main)
          (gdk-threads-leave)
          </pre>
     </td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-threads-handler?</b><i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Return true if <code>gtk-threads-ensure-handler</code> has started a Gtk main loop. 
</td></tr>
</table>

   </body></html>

