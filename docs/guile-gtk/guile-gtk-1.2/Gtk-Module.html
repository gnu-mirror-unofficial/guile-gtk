<html lang="en">
<head>
<title>Gtk Guile </title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="How to install and use the Guile interface to Gtk, version .">
<meta name="generator" content="makeinfo 4.5">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home">
<!--
This manual describes how to install and use the Guile interface to Gtk,
version .

   <p>Copyright 2003 Kevin Ryde.

   <p>Permission is granted to make and distribute verbatim copies of
this manual provided the copyright notice and this permission notice
are preserved on all copies.

   <p>Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the entire
resulting derived work is distributed under the terms of a permission
notice identical to this one.

   <p>Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions,
except that this permission notice may be stated in a translation approved
by Free Software Foundation.-->
</head>
<body>
<div class="node">
<p>
Node:<a name="Gtk%20Module">Gtk Module</a>,
Next:<a rel="next" accesskey="n" href="Gtk-Extras.html#Gtk%20Extras">Gtk Extras</a>,
Previous:<a rel="previous" accesskey="p" href="Gdk-Extras.html#Gdk%20Extras">Gdk Extras</a>,
Up:<a rel="up" accesskey="u" href="index.html#Top">Top</a>
<hr><br>
</div>

<h2 class="chapter">Gtk Module</h2>

<p>The Gtk interface module can be used with

<pre class="example">     (use-modules (gtk gtk))
     </pre>

   <p>Calls to <code>gtk_init</code> and <code>gtk_set_locale</code> are made automatically, an
application doesn't need to make them itself.  Standard Gtk command line
options are taken from the program command line (eg. <code>--gtk-module</code>),
and removed from there, leaving other options and the rest of the command line
for the application.  see <a href="../guile/Runtime-Environment.html#Runtime%20Environment">Runtime Environment</a>.

   <p>The following rules apply to the various Gtk types.

     <dl>
<dt><code>GtkObject</code>
     <dd>Each <code>GtkObject</code> is represented uniquely at the Scheme level, so widgets
etc can be compared or hashed with <code>eq?</code>.  An object will be destroyed
when garbage collected, assuming it's not otherwise in use by Gtk.

     <p>Type predicates like <code>GTK_IS_CHECK_BUTTON</code> are implemented as for
instance <code>gtk-check-button?</code>.  There are no type checking casts like in
C, Guile Gtk functions expecting a particular object class always check they
get it or a sub-class.

     <br><dt><code>GtkAdjustment</code>
     <dd>The following field accessors and setters are provided.

     <p>
<table width="100%">
<tr>
<td align="left"><b>gtk-adjustment-value</b><i> adj
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gtk-adjustment-lower</b><i> adj
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gtk-adjustment-upper</b><i> adj
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gtk-adjustment-step-increment</b><i> adj
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gtk-adjustment-page-increment</b><i> adj
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gtk-adjustment-page-size</b><i> adj
          </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
</td></tr>
</table>

     <p>
<table width="100%">
<tr>
<td align="left"><b>gtk-adjustment-set-lower</b><i> adj val
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gtk-adjustment-set-upper</b><i> adj val
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gtk-adjustment-set-step-increment</b><i> adj val
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gtk-adjustment-set-page-increment</b><i> adj val
          </i></td>
<td align="right">Function</td>
</tr>

     <tr>
<td align="left"><b>gtk-adjustment-set-page-size</b><i> adj val
          </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
These only set the respective fields, it's up to an application to emit the
standard <code>changed</code> signal when ready.

          <p>Note that <code>gtk-adjustment-set-value</code> is instead the corresponding
standard Gtk function.  It sets the value field and emits the
<code>value_changed</code> signal. 
</td></tr>
</table>

     <br><dt><code>GtkType</code>
     <dd><code>GtkType</code> values are represented as a distinct category of Scheme level
objects, except for <code>GTK_TYPE_INVALID</code> which is represented as <code>#f</code>. 
Types can be compared with <code>equal?</code>.

     <p>As a convenience, functions expecting a <code>GtkType</code> can be passed a symbol
which is the name of the type, to be looked up the same way
<code>gtk-type-from-name</code> does for a string.  For example,

     <pre class="example">          (gtk-widget-new 'GtkLabel)
          </pre>

     <br><dt>Signals
     <dd>Signal names are strings, the same as at the C level, for instance
<code>"clicked"</code> or <code>"map_event"</code>.

     <p>Signal handler procedures are passed the same parameters as the C code
functions, except the object and client-data are omitted.  The return value is
used when the signal expects a return value.

     <p>For instance the <code>clicked</code> signal from a <code>GtkButton</code> passes no
parameters,

     <pre class="example">          (define (my-click-handler)
            (display "hello\n"))
          (gtk-signal-connect button "clicked" my-click-handler)
          </pre>

     <p>Or an <code>expose_event</code> passes just a <code>GdkEvent</code>, and expects a return
value.

     <pre class="example">          (define (my-expose-handler)
            (do-some-drawing)
            #f)  ;; propagate event to other handlers
          (gtk-signal-connect drawarea "expose_event" my-expose-handler)
          </pre>

     <p>The object and client data parameters in the C level calls are deliberately
omitted.  Such things can be handled in a more Scheme-like and flexible way
with a closure, ie. captured variables with desired values (see <a href="../guile/About-Closure.html#About%20Closure">The Concept of Closure</a>).

     <p>Signal handler calls are made via a trampoline to facilitate error handling,
See <a href="Gtk-Extras.html#Gtk%20Extras">Gtk Extras</a>. 
</dl>

<br><p>
<p>The following standard Gtk functions have particular notes for the Guile Gtk
interface.

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-box-pack-start</b><i> box child </i>[<i>expand </i>[<i>fill </i>[<i>padding</i>]<i></i>]<i></i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gtk-box-pack-end</b><i> box child </i>[<i>expand </i>[<i>fill </i>[<i>padding</i>]<i></i>]<i></i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<var>expand</var> and <var>fill</var> default to <code>#f</code>, <var>padding</var> defaults to 0. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-color-selection-get-color</b><i> colorsel
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Return a <code>GdkColor</code> object with red, green and blue fields set to the
current colour from <var>colorsel</var>.  The colour is not allocated in any
colormap and the pixel field is zero.

     <p>Note that unfortunately this is not the same as the C function
<code>gtk_color_selection_get_color</code>, but instead like the Gtk 2
<code>gtk_color_selection_get_current_color</code>. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-color-selection-set-color</b><i> colorsel color
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Set the current colour in <var>colorsel</var> to the red, green and blue fields of
the given <code>GdkColor</code> object.  The opacity is set to 1.0, when in use.

     <p>Note that unfortunately this is not the same as the C function
<code>gtk_color_selection_set_color</code>, but instead like the Gtk 2
<code>gtk_color_selection_set_current_color</code>. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-exit</b><i> </i>[<i>exitcode</i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<var>exitcode</var> defaults to 0, meaning normal successful termination. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-idle-add</b><i> proc
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gtk-idle-add-priority</b><i> priority proc
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gtk-idle-add-full</b><i> priority proc
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
As per the signal handlers, there is no "data" parameter to the idle
callbacks.  <var>proc</var> is simply called <code>(</code><var>proc</var><code>)</code> and should return
non-<code>#f</code> to continue being called, or <code>#f</code> to no longer be called.

     <p>Currently there's no destroy notify callback procedure for
<code>gtk-idle-add-full</code>, perhaps this will change in the future. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-main</b><i>
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gtk-main-iteration</b><i>
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gtk-main-iteration-do</b><i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
In a signal handler or other callback, an application cannot use an exception
or new continuation to escape from <code>gtk-main</code> and friends, since Gtk has
no understanding of such things.  There are no restrictions on control flow
within a callback, just on escaping out of it.

     <p>One possibility for applications wanting such things is to have an explicit
loop calling <code>gtk-main-iteration</code> and hold a list of pending actions to
be taken outside that function.  This is done in the sample
<code>continuations.scm</code> (see <a href="Example-Programs.html#Example%20Programs">Example Programs</a>).  The callback trampoline
feature might be able to help with this (see <a href="Gtk-Extras.html#Gtk%20Extras">Gtk Extras</a>). 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-pixmap-new</b><i> pixmap </i>[<i>bitmap</i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gtk-pixmap-set</b><i> pixmap </i>[<i>bitmap</i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<var>bitmap</var> defaults to <code>#f</code>, meaning no mask. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-scrolled-window-new</b><i> </i>[<i>hadjustment </i>[<i>vadjustment</i>]<i></i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<var>hadjustment</var> and <var>vadjustment</var> default to <code>#f</code>, meaning create
new adjustment objects. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-set-locale</b><i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<code>gtk-set-locale</code> is called automatically when the <code>(gtk gtk)</code> module
is loaded, so applications don't need to do so explicitly. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-signal-connect</b><i> object name func </i>[<i>objectsignal </i>[<i>after</i>]<i></i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<var>objectsignal</var> has no purpose and should always be <code>#f</code>, which is its
default.  <var>after</var> defaults to <code>#f</code>, meaning <var>func</var> is called
before <var>object</var> runs the default handler for this signal.

     <p>It will be noted that <code>gtk-signal-connect</code> has the <var>objectsignal</var> and
<var>after</var> parameters like <code>gtk_signal_connect_full</code>, but currently
there's no access to the destroy notify callback. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-table-attach</b><i> table child left right top bottom </i>[<i>xopts </i>[<i>yopts </i>[<i>xpad </i>[<i>ypad</i>]<i></i>]<i></i>]<i></i>]<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
<var>xopts</var> and <var>yopts</var> each default to <code>(expand fill)</code>, <var>xpad</var>
and <var>ypad</var> default to 0. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-object-get</b><i> object prop
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
Get an object property.  The <var>prop</var> property name can be either a keyword
or symbol.  The property value is returned, or <code>#f</code> if there's no such
property or it cannot be read.

     <p><code>gtk-object-get</code> only gets one property value, unlike the C function
<code>gtk_object_get</code> which can get multiple property values in one call. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-object-new</b><i> type </i>[<i>prop value</i>]<i><small class="dots">...</small>
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gtk-object-set</b><i> object </i>[<i>prop value</i>]<i><small class="dots">...</small>
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gtk-widget-new</b><i> type </i>[<i>prop value</i>]<i><small class="dots">...</small>
     </i></td>
<td align="right">Function</td>
</tr>

<tr>
<td align="left"><b>gtk-widget-set</b><i> widget </i>[<i>prop value</i>]<i><small class="dots">...</small>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
The <var>prop</var> property names are taken as either keywords or symbols,
followed by suitable values.  This is in contrast to the C functions, where
strings are used for property names.  For example,

     <pre class="example">          (gtk-widget-new 'GtkButton #:label "some words" #:relief 'half)
          </pre>

     <p>The values set are type checked and converted in the usual way, they must
correspond to the property type. 
</td></tr>
</table>

<br><p>
<p>The following standard Gdk functions are not provided.

<p>
<table width="100%">
<tr>
<td align="left"><b>gtk-init</b><i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
There is no separate init function to call, all initializations are done
automatically when the <code>(gtk gtk)</code> module is loaded. 
</td></tr>
</table>

   </body></html>

